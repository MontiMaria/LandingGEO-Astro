---
// src/components/CardSpotlight.astro
const {
  imgSrc = null,
  title = 'Título por Defecto',
  text = null,
  titleSize = 'text-xl',
  layout = 'default'
} = Astro.props;

// Clases base que todas las tarjetas comparten
const baseClasses = "group relative flex h-full flex-col overflow-hidden rounded-xl shadow-xl";

// Clases que cambian según el layout
const layoutClasses = {
  default: "bg-indigo-900 p-8",
  'image-left': "bg-indigo-900 justify-between p-8 text-left",
  carousel: "border border-gray-200 bg-white justify-center p-6 text-center"
};
---

<div class:list={[baseClasses, layoutClasses[layout]]}>
  
  {/* 2. El spotlight se aplica condicionalmente, sin cambios */}
  {layout !== 'carousel' && (
    <div class="pointer-events-none absolute inset-0 z-10 transition-opacity duration-500 before:absolute before:inset-0 before:h-full before:w-full before:bg-gradient-radial before:from-blue-400/50 before:to-transparent before:opacity-0 before:transition-opacity before:duration-500 group-hover:before:opacity-100"></div>
  )}

  <div class="relative z-20">
    {layout === 'default' && (
      <div>
        {imgSrc && <img src={imgSrc} alt={`Imagen para ${title}`} class="mx-auto mb-4 h-20 w-20 object-cover" />}
        <h3 class:list={[titleSize, 'font-principal text-white']} set:html={title}></h3>
        {text && <p class="mt-2 text-[0.9rem] leading-relaxed text-gray-400">{text}</p>}
      </div>
    )}

    {layout === 'image-left' && (
      <>
        {text && <p class="leading-relaxed text-gray-400">{text}</p>}
        <div class="flex items-center gap-4 mt-8">
          {imgSrc && <img src={imgSrc} alt={`Imagen para ${title}`} class="h-16 w-16 shrink-0 rounded-full object-cover" />}
          <h3 class:list={[titleSize, 'text-[1rem] mt-2 text-white']} set:html={title}></h3>
        </div>
      </>
    )}

    {layout === 'carousel' && (
      <>
        {imgSrc && <img src={imgSrc} alt={`Imagen para ${title}`} class="mx-auto mb-4 h-16 w-16 object-cover" />}
        <h3 class:list={[titleSize, 'font-principal text-gray-800']} set:html={title}></h3>
        {text && <p class="mt-2 text-sm leading-relaxed text-gray-600">{text}</p>}
      </>
    )}
  </div>
</div>

<style>
  .group:hover .before\:bg-gradient-radial::before {
    background-image: radial-gradient(
      circle 250px at var(--mouse-x) var(--mouse-y),
      rgba(46, 123, 182, 0.295),
      transparent 80%
    );
  }
</style>

<script>
  document.querySelectorAll('.group').forEach(card => {
    card.addEventListener('mousemove', (e) => {
      const rect = card.getBoundingClientRect();
      const x = e.clientX - rect.left;
      const y = e.clientY - rect.top;
      card.style.setProperty('--mouse-x', `${x}px`);
      card.style.setProperty('--mouse-y', `${y}px`);
    });
  });
</script>